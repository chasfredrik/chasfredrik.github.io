(this["webpackJsonpreact-sl-info"]=this["webpackJsonpreact-sl-info"]||[]).push([[0],{17:function(e){e.exports=JSON.parse('{"APIKEY_REALTIMEINFO":"f488121bc66b4a3e9300fc43ac5af719","APIKEY_NEARME":"c05e240e9364450889e2b12985f6bb07","APIKEY_LOCATION":"9b2f96745bc542e481babe3688740147"}')},79:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n(0),s=n.n(r),a=n(12),i=n.n(a),j=(n(53),n(29)),o=n(6),l=n(43),b=s.a.createContext({}),h=n(24),d=n.n(h),u=n(30),O=n(13),x=n(86),p=n(87),m=n(88),f=n(89),g=n(91),v=n(90),E=n(15),N=n(16),I=n(22),A=n(21),y=function(e){Object(I.a)(n,e);var t=Object(A.a)(n);function n(e){var c;return Object(E.a)(this,n),(c=t.call(this,e)).state={hasError:!1},c}return Object(N.a)(n,[{key:"render",value:function(){return this.state.hasError?Object(c.jsx)("h4",{children:"H\xe4r \xe4r det tyv\xe4rr lite trasigt"}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return console.log("An unhandled error occurred,",e),{hasError:!0}}}]),n}(s.a.Component),S=s.a.createContext({ErrorText:"",SetErrorText:function(){}}),M=n(85);function T(e){var t=e.stop,n=Object(o.f)(),s=Object(r.useState)("-"),a=Object(O.a)(s,2),i=a[0],j=a[1],l=Object(r.useContext)(b),h=Object(r.useContext)(S),d=t.mainMastExtId.substring(5);return Object(r.useEffect)((function(){l.GetNextDeparture(d).then((function(e){j(e)}),(function(e){return t=e,void h.setErrorMsg({Text:"Misslyckades med att h\xe4mta avg\xe5ngar",Error:t.message});var t}))}),[l,d]),Object(c.jsxs)("tr",{className:"pointer",onClick:function(){return n.push("/stop/".concat(d,"/").concat(t.name))},children:[Object(c.jsxs)("td",{children:[t.dist," m"]}),Object(c.jsx)("td",{children:t.name}),Object(c.jsx)(y,{children:Object(c.jsx)(k,{NextDep:i})})]})}function k(e){var t=e.NextDep;return void 0===t||null===t||0===t.length?Object(c.jsx)("td",{children:Object(c.jsx)("b",{children:"-"})}):Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("td",{children:t[0].DisplayTime}),Object(c.jsxs)("td",{children:[Object(c.jsx)(M.a,{pill:!0,variant:"danger",children:t[0].LineNumber})," ",t[0].Destination]})]})}var C=function(e){var t=e.Lista;return null===t||void 0===t?null:Object(c.jsxs)("table",{className:"table table-hover",children:[Object(c.jsx)("thead",{"data-testid":"table-header",children:Object(c.jsxs)("tr",{className:"table-primary",children:[Object(c.jsx)("th",{children:"Avst\xe5nd"}),Object(c.jsx)("th",{children:"H\xe5llplats"}),Object(c.jsx)("th",{children:"N\xe4sta avg\xe5ng"}),Object(c.jsx)("th",{children:"Destination"})]})}),Object(c.jsx)("tbody",{children:t.map((function(e,t){return Object(c.jsx)(y,{children:Object(c.jsx)(T,{stop:e.StopLocation})},t)}))})]})};var P=function(){var e=Object(r.useState)(null),t=Object(O.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)([]),i=Object(O.a)(a,2),j=i[0],o=i[1],l=Object(r.useState)(!1),h=Object(O.a)(l,2),E=h[0],N=h[1],I=Object(r.useState)({}),A=Object(O.a)(I,2),M=A[0],T=A[1],k=Object(r.useState)(""),P=Object(O.a)(k,2),L=P[0],_=P[1],K=Object(r.useState)([]),D=Object(O.a)(K,2),Y=D[0],w=D[1],F=Object(r.useRef)(null),R=Object(r.useContext)(b);function U(){return(U=Object(u.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.target.value.length){e.next=2;break}return e.abrupt("return");case 2:n=t.target.value,_(n),n.length>2&&R.LookupPlaces(n).then((function(e){return w(e)}),(function(e){return T({Text:"Misslyckades med att h\xe4mta adresser",Error:e.message})}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){null!==n&&R.UpdateStopInfo(n).then((function(e){o(e)}),(function(e){T({Text:"Misslyckades med att h\xe4mta h\xe5llplatser",Error:e.message})}))}),[R,n]),Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(S.Provider,{value:{errorMsg:M,setErrorMsg:T},children:Object(c.jsxs)(x.a,{children:[Object(c.jsx)(p.a,{children:Object(c.jsx)(m.a,{children:Object(c.jsx)("div",{className:"jumbotron",children:Object(c.jsx)("h1",{children:"N\xe4r g\xe5r n\xe4sta buss?"})})})}),Object(c.jsxs)(p.a,{children:[Object(c.jsx)(m.a,{xs:"6",md:"3",children:Object(c.jsxs)("div",{className:"custom-control custom-switch",children:[Object(c.jsx)("input",{type:"checkbox",className:"custom-control-input",id:"customSwitch1",checked:E,onChange:function(e){e.target.checked?(o([]),navigator.geolocation.getCurrentPosition((function(e){N(!0),s(e.coords)}),(function(e){switch(e.code){case e.PERMISSION_DENIED:T({Text:"Saknar beh\xf6righet att h\xe4mta din position"});break;case e.POSITION_UNAVAILABLE:case e.TIMEOUT:T({Text:"Kunde ej h\xe4mta din position"})}}))):(N(!1),s(null))}}),Object(c.jsx)("label",{className:"custom-control-label",htmlFor:"customSwitch1",children:"Anv\xe4nd min plats"})]})}),Object(c.jsxs)(m.a,{xs:"6",md:"4",children:[Object(c.jsx)("div",{className:"form-group",hidden:E,children:Object(c.jsx)("input",{"data-testid":"Adress",className:"form-control form-control-sm",type:"text",placeholder:"Adress",id:"inputSmall",value:L,onChange:function(e){return U.apply(this,arguments)},ref:F})}),Object(c.jsx)(y,{children:Object(c.jsx)(f.a,{show:Y.length>0,target:F.current,placement:"bottom",containerPadding:20,children:Object(c.jsx)(g.a,{id:"popover-contained",children:Object(c.jsx)(g.a.Content,{children:Y.map((function(e,t){return Object(c.jsxs)("div",{className:"pointer",onClick:function(){_(e.Name),function(e){B.apply(this,arguments)}(e)},children:["Station"===e.Type?"(H) ":"",e.Name]},t)}))})})})})]})]}),Object(c.jsx)(p.a,{hidden:0===Object.keys(M).length,children:Object(c.jsx)(m.a,{xs:"6",children:Object(c.jsxs)(v.a,{variant:"danger",dismissible:!0,onClose:function(){return T({})},children:[Object(c.jsx)("strong",{children:M.Text}),Object(c.jsx)("br",{}),Object(c.jsx)("i",{children:M.Error})]})})}),Object(c.jsx)(p.a,{children:Object(c.jsx)(m.a,{children:Object(c.jsx)(y,{children:Object(c.jsx)(C,{Lista:j})})})})]})})});function B(){return(B=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w([]),o([]),R.UpdateStopInfo({latitude:t.Y.substring(0,2)+"."+t.Y.substring(2),longitude:t.X.substring(0,2)+"."+t.X.substring(2)}).then((function(e){o(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},L=n(18),_=function(e){Object(I.a)(n,e);var t=Object(A.a)(n);function n(e){var c;return Object(E.a)(this,n),(c=t.call(this,e)).state={errorMsg:{},nextStops:[]},c}return Object(N.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.siteId;try{this.context.GetNextDeparture(t).then((function(t){return e.setState((function(e){return Object(L.a)(Object(L.a)({},e),{},{nextStops:t})}))}))}catch(n){this.setState((function(e){return Object(L.a)(Object(L.a)({},e),{},{errorMsg:{Text:"Misslyckades med att h\xe4mta avg\xe5ngar",Error:n.message}})}))}}},{key:"render",value:function(){var e=this;return Object(c.jsxs)(x.a,{children:[Object(c.jsx)(p.a,{children:Object(c.jsx)(m.a,{children:Object(c.jsxs)("div",{className:"jumbotron",children:[Object(c.jsx)("h4",{children:"N\xe4r g\xe5r n\xe4sta buss fr\xe5n"}),Object(c.jsx)("h1",{children:this.props.match.params.siteName})]})})}),Object(c.jsx)(p.a,{hidden:0===Object.keys(this.state.errorMsg).length,children:Object(c.jsx)(m.a,{xs:"6",children:Object(c.jsxs)(v.a,{variant:"danger",dismissible:!0,onClose:function(){e.setState((function(e){return Object(L.a)(Object(L.a)({},e),{},{errorMsg:{}})}))},children:[Object(c.jsx)("strong",{children:this.state.errorMsg.Text}),Object(c.jsx)("br",{}),Object(c.jsx)("i",{children:this.state.errorMsg.Error})]})})}),Object(c.jsx)(p.a,{children:Object(c.jsx)(m.a,{children:Object(c.jsxs)("table",{className:"table table-hover",children:[Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{className:"table-primary",children:[Object(c.jsx)("th",{children:"Avg\xe5ng"}),Object(c.jsx)("th",{children:"Linje"}),Object(c.jsx)("th",{children:"Destination"})]})}),Object(c.jsxs)("tbody",{children:[this.state.nextStops.map((function(e,t){return Object(c.jsx)(y,{children:Object(c.jsx)(K,{stop:e})},t)})),0===this.state.nextStops.length?Object(c.jsx)("tr",{children:Object(c.jsx)("td",{colSpan:"4",children:"Inga avg\xe5ngar n\xe4rmaste timmen"})}):null]})]})})})]})}}]),n}(s.a.Component);_.contextType=b;var K=function(e){Object(I.a)(n,e);var t=Object(A.a)(n);function n(){return Object(E.a)(this,n),t.apply(this,arguments)}return Object(N.a)(n,[{key:"render",value:function(){var e=this.props.stop;return Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:e.DisplayTime}),Object(c.jsx)("td",{children:Object(c.jsx)(M.a,{pill:!0,variant:"danger",children:e.LineNumber})}),Object(c.jsx)("td",{children:e.Destination})]})}}]),n}(s.a.Component),D=_,Y=(n(79),n(17)),w=new l.a({apiKey_realtimeInfo:Y.APIKEY_REALTIMEINFO,apiKey_nearMe:Y.APIKEY_NEARME,apiKey_location:Y.APIKEY_LOCATION});var F=function(){return Y.APIKEY_REALTIMEINFO?Y.APIKEY_NEARME?Y.APIKEY_LOCATION?Object(c.jsx)(b.Provider,{value:w,children:Object(c.jsx)(j.a,{children:Object(c.jsxs)(o.c,{children:[Object(c.jsx)(o.a,{path:"/stop/:siteId/:siteName",component:D}),Object(c.jsx)(o.a,{children:Object(c.jsx)(P,{})})]})})}):Object(c.jsx)("h2",{children:"Missing APIKEY_LOCATION in config.json"}):Object(c.jsx)("h2",{children:"Missing APIKEY_NEARME in config.json"}):Object(c.jsx)("h2",{children:"Missing APIKEY_REALTIMEINFO in config.json"})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,92)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),s(e),a(e)}))};i.a.render(Object(c.jsx)(F,{}),document.getElementById("root")),R()}},[[80,1,2]]]);
//# sourceMappingURL=main.1461fc2e.chunk.js.map